<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{admin/layouts/index.html}">

<head>
</head>

<body>
    <section layout:fragment="content" class="container">
        <div id="toastsCustomCss">
            <div id="messageSuccess" th:if="${messageSuccess}" class="toast" role="alert" aria-live="assertive"
                aria-atomic="true" data-delay="2000">
                <div class="toast-header">
                    <svg class="bd-placeholder-img rounded mr-2" width="20" height="20"
                        xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false"
                        role="img">
                        <rect width="100%" height="100%" fill="#007aff"></rect>
                    </svg>
                    <!-- <img src="..." class="rounded mr-2" alt="..."> -->
                    <strong class="mr-auto">Thông báo hệ thống</strong>
                    <small>Now</small>
                    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">
                    <span id="messageSuccessBodyId" th:text="${messageSuccess}"></span>
                </div>
            </div>
            <div id="messageDanger" th:if="${messageDanger}" class="toast" role="alert" aria-live="assertive"
                aria-atomic="true" data-delay="2000">
                <div class="toast-header">
                    <svg class="bd-placeholder-img rounded mr-2" width="20" height="20"
                        xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false"
                        role="img">
                        <rect width="100%" height="100%" fill="red"></rect>
                    </svg>
                    <!-- <img src="..." class="rounded mr-2" alt="..."> -->
                    <strong class="mr-auto">Thông báo hệ thống</strong>
                    <small>Now</small>
                    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">
                    <span id="messageDangerBodyId" th:text="${messageDanger}"></span>
                </div>
            </div>
            <div id="toastAjax" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay="2000">
            </div>
        </div>
        <form enctype="multipart/form-data" id="flexUrlTableFormAddProduct" th:object="${sanPhamManageDTO}">
            <div id="myForm">
                <div class="card shadow mb-1 pt-sm-2 pb-sm-3">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            Thêm mới sản phẩm
                        </h5>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" th:field="*{isEdit}" />
                        <input type="hidden" th:field="*{isCreatedImg}" />
                        <input type="hidden" th:field="*{isCreatedValueImg}" />
                        <div class="form-group mt-2">
                            <input type="text" class="form-control" name="productId" id="productId"
                                aria-describedby="productId" placeholder="productId" th:field="*{sanPhamId}" readonly
                                hidden />
                        </div>
                        <div class="col-sm-12 row">
                            <div class="row">
                                <div class="col-sm-6 ">
                                    <label for="tenSanPham">Tên sản phẩm:</label>
                                    <input type="text" class="form-control" name="tenSanPham" th:classappend="${#fields.hasErrors('tenSanPham')}?
                                            is-invalid : ''" id="tenSanPhamSearch" placeholder="Tên sản phẩm"
                                        th:field="*{tenSanPham}" />
                                    <small id="tenSanPham" th:if="${#fields.hasErrors('tenSanPham')}" th:class="${#fields.hasErrors('tenSanPham')}?
                                            invalid-feedback : ''" th:errors="*{tenSanPham}"></small>
                                </div>
                                <div class="col-sm-6">
                                    <label for="gia">Giá:</label>
                                    <input type="number" class="form-control" name="gia" id="gia" th:classappend="${#fields.hasErrors('gia')}?
                                            is-invalid : ''" aria-describedby="giaHId" placeholder="Giá bán"
                                        th:field="*{gia}" />
                                    <small id="gia" th:if="${#fields.hasErrors('gia')}" th:class="${#fields.hasErrors('gia')}?
                                            invalid-feedback : ''" th:errors="*{gia}"></small>
                                </div>
                                <div class="col-sm-3 mt-3">
                                    <div class="row">
                                        <div class="col-12"><label for="loaiSanPhamId">Loại sản phẩm:</label></div>
                                        <div class="col-10" style="padding-right: 3px;">
                                            <select class="form-control" name="loaiSanPhamId" id="loaiSanPhamId"
                                                th:classappend="${#fields.hasErrors('loaiSanPhamId')}?
                                                is-invalid : ''" th:field="*{loaiSanPhamId}">
                                                <option value="-1" selected>Chưa chọn</option>
                                                <option th:each="item :
                                                    ${lstLoaiSanPham}" th:value="${item.id}"
                                                    th:text="${item.tenLoaiSanPham}" th:selected="${item.id ==
                                                    sanPhamManageDTO.loaiSanPhamId}"></option>
                                            </select>
                                            <small id="loaiSanPhamId" th:if="${#fields.hasErrors('loaiSanPhamId')}"
                                                th:class="${#fields.hasErrors('loaiSanPhamId')}?
                                                invalid-feedback : ''" th:errors="*{loaiSanPhamId}"></small>
                                        </div>
                                        <div class="col-2" style="padding-left: 0;">
                                            <a class="btn btn-outline-info"
                                                onclick="openPopupIsShowSpeedAddProduct('Loại sản phẩm', 'loaiSanPham')">
                                                <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-3 mt-3">
                                    <div class="row">
                                        <div class="col-12">
                                            <label for="kieuDangId">Tên kiểu dáng:</label>
                                        </div>
                                        <div class="col-10" style="padding-right: 3px;">
                                            <select class="form-control" name="kieuDangId" id="kieuDangId"
                                                th:classappend="${#fields.hasErrors('kieuDangId')}?
                                                is-invalid : ''" th:field="*{kieuDangId}">
                                                <option value="-1" selected>Chưa chọn</option>
                                                <option th:each="item : ${lstKieuDang}" th:value="${item.id}"
                                                    th:text="${item.tenKieuDang}" th:selected="${item.id ==
                                                    sanPhamManageDTO.kieuDangId}">
                                                </option>
                                            </select>
                                            <small id="kieuDangId" th:if="${#fields.hasErrors('kieuDangId')}" th:class="${#fields.hasErrors('kieuDangId')}?
                                            invalid-feedback : ''" th:errors="*{kieuDangId}"></small>
                                        </div>
                                        <div class="col-2" style="padding-left: 0;">
                                            <a class="btn btn-outline-info"
                                                onclick="openPopupIsShowSpeedAddProduct('Tên kiểu dáng', 'kieuDang')">
                                                <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-3 mt-3">
                                    <div class="row">
                                        <div class="col-12"><label for="chatLieuId">Tên chất liệu:</label></div>
                                        <div class="col-10" style="padding-right: 3px;">
                                            <select class="form-control" name="chatLieuId" id="chatLieuId"
                                                th:classappend="${#fields.hasErrors('chatLieuId')}?
                                            is-invalid : ''" th:field="*{chatLieuId}">
                                                <option value="-1" selected>Chưa chọn</option>
                                                <option th:each="item : ${lstChatLieu}" th:value="${item.id}"
                                                    th:text="${item.tenChatLieu}" th:selected="${item.id
                                                        == sanPhamManageDTO.chatLieuId}"></option>
                                            </select>
                                            <small id="chatLieuId" th:if="${#fields.hasErrors('chatLieuId')}" th:class="${#fields.hasErrors('chatLieuId')}?
                                            invalid-feedback : ''" th:errors="*{chatLieuId}"></small>
                                        </div>
                                        <div class="col-2" style="padding-left: 0;">
                                            <a class="btn btn-outline-info"
                                                onclick="openPopupIsShowSpeedAddProduct('Tên chất liệu', 'chatLieu')">
                                                <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-3 mt-3">
                                    <div class="row">
                                        <div class="col-12"><label for="phongCachId">Tên phong cách:</label></div>
                                        <div class="col-10" style="padding-right: 3px;">
                                            <select class="form-control" name="phongCachId" id="phongCachId"
                                                th:classappend="${#fields.hasErrors('phongCachId')}?
                                                is-invalid : ''" th:field="*{phongCachId}">
                                                <option value="-1" selected>Chưa chọn</option>
                                                <option th:each="item : ${lstPhongCach}" th:value="${item.id}"
                                                    th:text="${item.tenPhongCach}" th:selected="${item.id ==
                                                    sanPhamManageDTO.phongCachId}"></option>
                                            </select>
                                            <small id="phongCachId" th:if="${#fields.hasErrors('phongCachId')}"
                                                th:class="${#fields.hasErrors('phongCachId')}?
                                                invalid-feedback : ''" th:errors="*{phongCachId}"></small>
                                        </div>
                                        <div class="col-2" style="padding-left: 0;">
                                            <a class="btn btn-outline-info"
                                                onclick="openPopupIsShowSpeedAddProduct('Tên phong cách', 'phongCach')">
                                                <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-12 mt-3">
                                    <label for="moTa">Mô tả sản phẩm:</label>
                                    <textarea form="flexUrlTableFormAddProduct" class="form-control" name="moTa"
                                        id="moTa" th:field="*{moTa}" placeholder="Mô tả chi tiết sản phẩm..."
                                        th:classappend="${#fields.hasErrors('moTa')}?
                                            is-invalid : ''" aria-describedby="moTaHId"></textarea>
                                    <small id="moTa" th:if="${#fields.hasErrors('moTa')}" th:class="${#fields.hasErrors('moTa')}?
                                            invalid-feedback : ''" th:errors="*{moTa}"></small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card shadow mb-4 mt-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold">
                            Kích cỡ và màu sắc
                        </h6>
                    </div>
                    <div class="col-sm-12 row" th:if="*{isEdit == false}">
                        <div class="col-sm-4 mt-3">
                            <div class="row">
                                <div class="col-12">
                                    <label for="kichCoIds">Tên kích cỡ:</label>
                                </div>
                                <div class="col-10" style="padding-right: 3px;">
                                    <select class="selectpicker" name="kichCoIds" id="kichCoIds" th:field="*{kichCoIds}"
                                        th:classappend="${#fields.hasErrors('kichCoIds')}?
                                            is-invalid : ''" multiple>
                                        <option th:each="item : ${lstKichCo}" th:value="${item.id}"
                                            th:text="${item.tenKichCo}">
                                        </option>
                                    </select>
                                    <small id="kichCoIds" th:if="${#fields.hasErrors('kichCoIds')}" th:class="${#fields.hasErrors('kichCoIds')}?
                                            invalid-feedback : ''" th:errors="*{kichCoIds}"></small>
                                </div>
                                <div class="col-2" style="padding-left: 0;">
                                    <a class="btn btn-outline-info"
                                        onclick="openPopupIsShowSpeedAddProduct('Tên kích cỡ', 'kichCo')">
                                        <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 mt-3 mb-3">
                            <div class="row">
                                <div class="col-12"><label for="mauSacIds">Tên màu sắc:</label></div>
                                <div class="col-10" style="padding-right: 3px;">
                                    <select class="selectpicker" name="mauSacIds" id="mauSacIds" th:field="*{mauSacIds}"
                                        th:classappend="${#fields.hasErrors('mauSacIds')}?
                                    is-invalid : ''" multiple>
                                        <option th:each="item : ${lstMauSac}" th:value="${item.id}">
                                            <span>
                                                <svg class="bd-placeholder-img rounded mr-2" width="20" height="20"
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    preserveAspectRatio="xMidYMid slice" focusable="false" role="img">
                                                    <rect width="100%" height="100%" fill="red"></rect>
                                                </svg>
                                                <span th:text="${item.tenMauSac}"></span>
                                            </span>
                                        </option>
                                    </select>
                                    <small id="mauSacIds" th:if="${#fields.hasErrors('mauSacIds')}" th:class="${#fields.hasErrors('mauSacIds')}?
                                    invalid-feedback : ''" th:errors="*{mauSacIds}"></small>
                                </div>
                                <div class="col-2" style="padding-left: 0;">
                                    <a class="btn btn-outline-info"
                                        onclick="openPopupIsShowSpeedAddProduct('Tên màu sắc', 'mauSac')">
                                        <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4 mt-3 mb-3">
                            <label for="soLuong">Số Lượng:</label>
                            <input type="number" class="form-control" name="soLuong" th:classappend="${#fields.hasErrors('soLuong')}?
                                is-invalid : ''" placeholder="Số Lượng sản phẩm" th:field="*{soLuong}" />
                            <small th:if="${#fields.hasErrors('soLuong')}" th:class="${#fields.hasErrors('soLuong')}?
                                invalid-feedback : ''" th:errors="*{soLuong}"></small>
                        </div>
                        <div class="col-sm-12 mt-3 mb-3">
                            <div class="float-right">
                                <a class="btn btn-primary" th:if="*{isEdit == false}"
                                    onclick="flexUrlSubmit('generateProductDetails', 'post', 'AddProduct')">
                                    <span>Tạo sản phẩm <img th:src="@{/admin/img/icons/box-arrow-down.svg}"
                                            aria-label="chi tiết" /></span>
                                </a>
                                <a class="btn btn-primary" th:if="*{isEdit == true}"
                                    onclick="flexUrlSubmit('add', 'get', 'AddProduct')">
                                    <span>Tạo mới sản phẩm <img th:src="@{/admin/img/icons/box-arrow-in-up.svg}"
                                            aria-label="chi tiết" /></span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 row" th:if="*{isEdit == true}">
                        <div class="col-sm-6 mt-3">
                            <div class="row">
                                <div class="col-12">
                                    <label for="kichCoIds">Tên kích cỡ:</label>
                                </div>
                                <div class="col-10" style="padding-right: 3px;">
                                    <select class="selectpicker" name="kichCoIds" id="kichCoIds" th:field="*{kichCoIds}"
                                        th:classappend="${#fields.hasErrors('kichCoIds')}?
                                            is-invalid : ''" multiple>
                                        <option th:each="item : ${lstKichCo}" th:value="${item.id}"
                                            th:text="${item.tenKichCo}">
                                        </option>
                                    </select>
                                    <small id="kichCoIds" th:if="${#fields.hasErrors('kichCoIds')}" th:class="${#fields.hasErrors('kichCoIds')}?
                                            invalid-feedback : ''" th:errors="*{kichCoIds}"></small>
                                </div>
                                <div class="col-2" style="padding-left: 0;">
                                    <a class="btn btn-outline-info"
                                        onclick="openPopupIsShowSpeedAddProduct('Tên kích cỡ', 'kichCo')">
                                        <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6 mt-3 mb-3">
                            <div class="row">
                                <div class="col-12"><label for="mauSacIds">Tên màu sắc:</label></div>
                                <div class="col-10" style="padding-right: 3px;">
                                    <select class="selectpicker" name="mauSacIds" id="mauSacIds" th:field="*{mauSacIds}"
                                        th:classappend="${#fields.hasErrors('mauSacIds')}?
                                    is-invalid : ''" multiple>
                                        <option th:each="item : ${lstMauSac}" th:value="${item.id}">
                                            <span>
                                                <svg class="bd-placeholder-img rounded mr-2" width="20" height="20"
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    preserveAspectRatio="xMidYMid slice" focusable="false" role="img">
                                                    <rect width="100%" height="100%" fill="red"></rect>
                                                </svg>
                                                <span th:text="${item.tenMauSac}"></span>
                                            </span>
                                        </option>
                                    </select>
                                    <small id="mauSacIds" th:if="${#fields.hasErrors('mauSacIds')}" th:class="${#fields.hasErrors('mauSacIds')}?
                                    invalid-feedback : ''" th:errors="*{mauSacIds}"></small>
                                </div>
                                <div class="col-2" style="padding-left: 0;">
                                    <a class="btn btn-outline-info"
                                        onclick="openPopupIsShowSpeedAddProduct('Tên màu sắc', 'mauSac')">
                                        <img th:src="@{/admin/img/icons/plus.svg}"></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 mt-3 mb-3">
                            <div class="float-right">
                                <a class="btn btn-primary" th:if="*{isEdit == false}"
                                    onclick="flexUrlSubmit('generateProductDetails', 'post', 'AddProduct')">
                                    <span>Tạo sản phẩm <img th:src="@{/admin/img/icons/box-arrow-down.svg}"
                                            aria-label="chi tiết" /></span>
                                </a>
                                <a class="btn btn-primary" th:if="*{isEdit == true}"
                                    onclick="flexUrlSubmit('add', 'get', 'AddProduct')">
                                    <span>Tạo mới sản phẩm <img th:src="@{/admin/img/icons/box-arrow-in-up.svg}"
                                            aria-label="chi tiết" /></span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card shadow mb-4 mt-4" th:if="${not #lists.isEmpty(dataGen)}">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold">
                        Bảng sản phẩm đã thêm mới
                        <div class="btn-group-sm">
                            <div class="float-right">
                                <a class="btn btn-danger" onclick="showConfirmModalDialogDeleteAllbyId()">Xóa</a>
                            </div>
                        </div>
                    </h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover" id="dataTable" width="100%" cellspacing="0">
                            <thead class="text-nowrap text-center">
                                <tr>
                                    <th>
                                        <div class="checkbox-wrapper-30">
                                            <span class="checkbox">
                                                <input type="checkbox" onclick="toggleProductIds(this)" />
                                                <svg>
                                                    <use xlink:href="#checkbox-30" class="checkbox"></use>
                                                </svg>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
                                                <symbol id="checkbox-30" viewBox="0 0 22 22">
                                                    <path fill="none" stroke="currentColor" d="M5.5,11.3L9,14.8L20.2,3.3l0,0c-0.5-1-1.5-1.8-2.7-1.8h-13c-1.7,0-3,1.3-3,3v13c0,1.7,1.3,3,3,3h13
                                                            c1.7,0,3-1.3,3-3v-13c0-0.4-0.1-0.8-0.3-1.2" />
                                                </symbol>
                                            </svg>
                                        </div>
                                    </th>
                                    <th>#</th>
                                    <!-- <th>Tên sản phẩm</th> -->
                                    <th>Số lượng</th>
                                    <!-- <th>Giá</th> -->
                                    <th>Kích cỡ</th>
                                    <th>Màu sắc</th>
                                    <!-- <th>Kiểu dáng</th>
                                    <th>Chất liệu</th>
                                    <th>Loại sản phẩm</th>
                                    <th>Phong cách</th> -->
                                    <!-- <th>Mô tả</th> -->
                                    <!-- <th>Người tạo</th>
                                    <th>Ngày tạo</th>
                                    <th>Người chỉnh sửa cuối</th>
                                    <th>Ngày chỉnh sửa cuối</th> -->
                                    <th>Có hiển thị</th>
                                    <th>Thao tác</th>
                                </tr>
                            </thead>
                            <tbody>
                                <th:block th:each="data, istat : ${dataGen}">
                                    <tr class="text-center">
                                        <th>
                                            <div class="checkbox-wrapper-30">
                                                <span class="checkbox">
                                                    <input type="checkbox" name="productIds" th:id="openBoxCreateImgsId
                                                                + ${data.id}" th:value="${data.id}"
                                                        onclick="openBoxCreateImgs(this.getAttribute('th:id'))" />
                                                    <svg>
                                                        <use xlink:href="#checkbox-30" class="checkbox"></use>
                                                    </svg>
                                                </span>
                                                <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
                                                    <symbol id="checkbox-30" viewBox="0 0 22 22">
                                                        <path fill="none" stroke="currentColor" d="M5.5,11.3L9,14.8L20.2,3.3l0,0c-0.5-1-1.5-1.8-2.7-1.8h-13c-1.7,0-3,1.3-3,3v13c0,1.7,1.3,3,3,3h13
                                                                    c1.7,0,3-1.3,3-3v-13c0-0.4-0.1-0.8-0.3-1.2" />
                                                    </symbol>
                                                </svg>
                                            </div>
                                        </th>
                                        <td th:text="${istat.index + 1}"></td>
                                        <!-- <td th:text="${data.sanPham.tenSanPham}"></td> -->
                                        <td>
                                            <input type="number" name="mauSacProductIds" th:value="${data.sanPham.id}"
                                                hidden />
                                            <input type="number" name="soLuongTheoIds" th:value="${data.id}" hidden />
                                            <input type="number" class="form-control" name="soLuongs" width="200px"
                                                placeholder="Số lượng sản phẩm" th:value="${data.soLuong}" />
                                        </td>
                                        <!-- <td th:text="${data.sanPham.gia}"></td> -->
                                        <td th:text="${data.kichCo.tenKichCo}"></td>
                                        <td th:text="${data.mauSac.tenMauSac}"></td>
                                        <!-- <td th:text="${data.sanPham.kieuDang.tenKieuDang}"></td>
                                        <td th:text="${data.sanPham.chatLieu.tenChatLieu}"></td>
                                        <td th:text="${data.sanPham.loaiSanPham.tenLoaiSanPham}"></td>
                                        <td th:text="${data.sanPham.phongCach.tenPhongCach}"></td> -->
                                        <!-- <td th:text="${item.sanPham.moTa}"></td> -->
                                        <!-- <td th:text="${item.nguoiTao}"></td>
                                        <td th:text="${item.ngayTao}"></td>
                                        <td th:text="${item.nguoiCapNhat}"></td>
                                        <td th:text="${item.ngayCapNhat}"></td> -->
                                        <td>
                                            <div class="custom-control
                                                            custom-switch
                                                            align-items-center">
                                                <input type="checkbox" class="custom-control-input" th:id="customSwitch
                                                                +
                                                                ${data.id}" th:data-id="${data.id}" th:checked="${data.coHienThi?
                                                                'true' : 'false'}" onclick="openPopupChangeIsShowFormAddProduct(this.getAttribute('id'),this.getAttribute('data-id'),
                                                                this.getAttribute('checked'))" />
                                                <label class="custom-control-label" th:for="customSwitch
                                                                +
                                                                ${data.id}"></label>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="btn-group">
                                                <a class="btn btn-outline-primary btn-sm" data-toggle="popover"
                                                    data-trigger="hover" data-placement="top"
                                                    data-content="Cập nhật sản phẩm chi tiết"
                                                    th:href="@{'/admin/product/productDetail/edit/' + ${data.id}} +'/addProduct'"
                                                    disabled><img th:src="@{/admin/img/icons/edit.svg}"></a>

                                                <a class="btn btn-outline-danger btn-sm" th:data-id="${data.id}"
                                                    data-toggle="popover" data-trigger="hover" data-placement="top"
                                                    data-content="Xóa sản phẩm chi tiết"
                                                    th:data-name="${data.mauSac.tenMauSac}"
                                                    onclick="showConfirmModalDialog(this.getAttribute('data-id'), this.getAttribute('data-name'))"><img
                                                        th:src="@{/admin/img/icons/trash.svg}"></a>
                                            </div>
                                        </td>
                                    </tr>
                                </th:block>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card-footer">
                    <h6 class="m-0 font-weight-bold text-primary">
                        <div class="btn-group-sm">
                            <div class="float-right">
                                <a class="btn btn-primary mr-sm-1" th:if="*{isCreatedImg == false}"
                                    onclick="flexUrlSubmit('addImageProductDetail', 'get','AddProduct')">Thêm ảnh
                                    sản
                                    phẩm</a>
                                <a class="btn btn-primary mr-sm-1"
                                    onclick="flexUrlSubmit('updateQuantityProductDetail', 'post', 'AddProduct')">Cập
                                    nhật</a>
                            </div>
                        </div>
                    </h6>
                </div>
            </div>
            <div class="card shadow mb-4 mt-4"
                th:if="${sanPhamManageDTO.lstHinhAnhMauSacDTO != null && !sanPhamManageDTO.lstHinhAnhMauSacDTO.isEmpty()}">
                <div>
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold">
                            Thêm hình ảnh cho sản phẩm
                        </h6>
                    </div>
                    <div class="col-sm-12">
                        <div class="col-sm-12 card mb-4 mt-4" th:each="item, istat : *{lstHinhAnhMauSacDTO}">
                            <div class="row">
                                <div class="col-sm-12 mt-3">
                                    <div class="col-sm-12">
                                        <input type="number" class="form-control"
                                            th:field="*{lstHinhAnhMauSacDTO[__${istat.index}__].mauSacAddImagesId}"
                                            name="mauSacAddImagesId" th:value="${item.mauSacAddImagesId}" hidden />
                                        <div th:if="*{isCreatedValueImg == false}">
                                            <h6>Tên màu sắc của sản phẩm đang thêm ảnh: <span
                                                    th:text="${item.tenMauSacAddImg}"></span></h6>
                                            <input type="file" th:id="'inp-add-' + ${istat.index}"
                                                th:name="'inp-add-' + ${istat.index}" multiple
                                                th:field="*{lstHinhAnhMauSacDTO[__${istat.index}__].imgFiles}">
                                            <br>
                                            <hr><br>
                                        </div>
                                        <div th:if="*{isCreatedValueImg == true}">
                                            <h6>Tên màu sắc của sản phẩm đang thêm ảnh: <span
                                                    th:text="${item.tenMauSacAddImg}"></span></h6>
                                            <div th:if="*{not #lists.isEmpty(lstHinhAnhMauSacDTO[__${istat.index}__].hinhAnhDTOs)}"
                                                th:each="img, istatHAMS : *{lstHinhAnhMauSacDTO[__${istat.index}__].hinhAnhDTOs}">
                                                <div
                                                    class="file-preview-frame krajee-default  kv-preview-thumb rotatable">
                                                    <div class="kv-file-content text-center">
                                                        <img th:src="${'/admin/product/images/' + img.tenAnh}"
                                                            style="width: auto; height: auto; max-width: 100%; max-height: 100%; image-orientation: from-image;"
                                                            alt="">
                                                    </div>
                                                    <div class="file-thumbnail-footer">
                                                        <div class="file-footer-caption"
                                                            title="50-mau-anh-chup-ao-thun-nam-1.jpg">
                                                            <div class="file-caption-info">Ảnh sản phẩm
                                                            </div>
                                                            <div class="file-size-info"></div>
                                                        </div>
                                                        <div class="file-thumb-progress kv-hidden">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-info progress-bar-info progress-bar-striped active progress-bar-animated"
                                                                    role="progressbar" aria-valuenow="101"
                                                                    aria-valuemin="0" aria-valuemax="100"
                                                                    style="width: 101%;">
                                                                    Initializing …
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="file-upload-indicator" title="Not uploaded yet"><i
                                                                class="bi-plus-lg text-warning"></i></div>
                                                        <div class="file-actions">
                                                            <div class="file-footer-buttons">
                                                                <input type="radio"
                                                                    th:name="'HinhAnhRadioName'+${istat.index}"
                                                                    th:checked="${img.laAnhChinh? 'true': 'false'}"
                                                                    th:img-name="${img.tenAnh}"
                                                                    th:id="'HinhAnhRadioId'+${istat.index}+${istatHAMS.index}"
                                                                    onclick="changeLaAnhChinh(this.getAttribute('checked'), this.getAttribute('img-name'))">
                                                            </div>
                                                            <div class="file-footer-buttons">
                                                                <input type="checkbox"
                                                                    th:checked="${img.coHienThi? 'true': 'false'}"
                                                                    th:img-name="${img.tenAnh}"
                                                                    onclick="changeCoHienThi(this.getAttribute('checked'), this.getAttribute('img-name'))">
                                                            </div>
                                                        </div>
                                                        <div class="clearfix"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script th:inline="javascript">
                                            $(document).ready(function () {
                                                var index1 = '[[${istat.index}]]';

                                                $('#inp-add-' + index1).fileinput({
                                                    uploadUrl: '#',
                                                    //uploadUrl: 'http://localhost/plugins/test-upload',
                                                    initialPreviewAsData: false,
                                                    // initialPreview: [

                                                    // ]
                                                })
                                            })
                                            function changeCoHienThi(checked, imgName) {
                                                                                      
                                                $.ajax({
                                                    url: "http://localhost:8080/admin/product/changeCoHienThi/" + imgName + "/" + !checked,
                                                    type: "GET",
                                                    contentType: "application/json",
                                                    success: function (result) {
                                                        var html = "<div class='toast-header'> <svg class='bd-placeholder-img rounded mr-2' width='20' height='20' xmlns='http://www.w3.org/2000/svg' preserveAspectRatio='xMidYMid slice' focusable='false' role='img'><rect width='100%' height='100%' fill='blue'></rect></svg><strong class='mr-auto'>Thông báo hệ thống</strong><small>Now</small><button type='button' class='ml-2 mb-1 close' data-dismiss='toast' aria-label='Close'><span aria-hidden='true'>&times;</span></button></div><div class='toast-body'>Cập nhật ảnh chính cho sản phẩm thành công</div>";
                                                        $('#toastsCustomCss').attr("style", "position: fixed; top: 10px; right: 0;z-index: 1;");
                                                        $('#toastAjax').html(html);
                                                        $("#toastAjax").toast("show");
                                                        
                                                    },
                                                    error: function (result) {
                                                        var html = "<div class='toast-header'> <svg class='bd-placeholder-img rounded mr-2' width='20' height='20' xmlns='http://www.w3.org/2000/svg' preserveAspectRatio='xMidYMid slice' focusable='false' role='img'><rect width='100%' height='100%' fill='red'></rect></svg><strong class='mr-auto'>Thông báo hệ thống</strong><small>Now</small><button type='button' class='ml-2 mb-1 close' data-dismiss='toast' aria-label='Close'><span aria-hidden='true'>&times;</span></button></div><div class='toast-body'>Cập nhật ảnh chính cho sản phẩm thất bại</div>";
                                                        $('#toastsCustomCss').attr("style", "position: fixed; top: 10px; right: 0;z-index: 1;");
                                                        $('#toastAjax').html(html);
                                                        $("#toastAjax").toast("show");
                                                    }
                                                });

                                            }
                                            function changeLaAnhChinh(checked, imgName) {
                                                $.ajax({
                                                    url: "http://localhost:8080/admin/product/changeLaAnhChinh/" + imgName + "/" + !checked,
                                                    type: "GET",
                                                    contentType: "application/json",
                                                });
                                            }
                                        </script>
                                    </div>
                                </div>
                                <hr class="mt-2 mb-2">
                            </div>
                        </div>
                        <hr>
                        <div class="col-sm-12 mt-3 pb-5">
                            <div class="float-right">
                                <a class="btn btn-primary"
                                    onclick="flexUrlSubmit('saveImageProductDetail', 'post', 'AddProduct')">
                                    <span>Hoàn tất thêm ảnh sản phẩm <img th:src="@{/admin/img/icons/save.svg}"
                                            aria-label="chi tiết" /></span></a>
                                <a class="btn btn-primary"
                                    onclick="flexUrlSubmit('', 'post', 'AddProduct')">
                                    <span>Quay trở về trang chủ <img th:src="@{/admin/img/icons/save.svg}"
                                            aria-label="chi tiết" /></span></a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- them -->
            </div>
            <!-- Modal iShowSpeed product -->
            <div class="modal fade" id="iShowSpeedModalId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
                aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h5 class="modal-title">Thêm giá trị thuộc tính cho sản phẩm</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="col-sm-12">
                                <input type="text" class="form-control" name="fieldthuocTinhInput"
                                    id="fieldthuocTinhInput" hidden />
                                <label>Tên thuộc tính: <span id="tenThuocTinh"></span></label>
                                <br>
                                <label for="tenThuocTinhInput">Giá trị thuộc tính:</label>
                                <input type="text" class="form-control" name="thuocTinhInput" id="tenThuocTinhInput" />
                            </div>
                            <div class="col-sm-12" id="maMauSacDiv">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a type="button" id="notChangeIsShow" class="btn btn-outline-dark"
                                data-dismiss="modal">Đóng</a>
                            <a id="yesOptionChangeIsShow" type="button" class="btn btn-danger"
                                onclick="flexUrlSubmit('saveOptionValue', 'post', 'AddProduct')">Lưu</a>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <!-- Modal delete -->
        <div class="modal fade" id="confirmationId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Xác nhận xóa sản
                            phẩm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">Bạn có muốn xóa sản
                        phẩm
                        này?</div>
                    <div class="modal-footer">
                        <a type="button" class="btn
                                            btn-outline-dark" data-dismiss="modal">Đóng</a>
                        <a id="yesOptionDeleteModalId" type="button" class="btn
                                            btn-danger">Xóa</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal isShow product -->
        <div class="modal fade" id="isShowModalId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Xác nhận thay
                            đổi
                            trạng thái hiển thị sản phẩm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Bạn có muốn thay đổi trạng thái hiển thị
                        của
                        sản phẩm đã chọn?
                    </div>
                    <div class="modal-footer">
                        <a type="button" id="notChangeIsShow" class="btn btn-outline-dark" data-dismiss="modal">Đóng</a>
                        <a id="yesOptionChangeIsShow" type="button" class="btn
                                            btn-danger">Đồng ý</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- modal add bo -->
        <div class="modal fade" id="imageModalId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
            aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Thêm ảnh sản
                            phẩm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <a type="button" id="notChangeIsShow" class="btn btn-outline-dark" data-dismiss="modal">Đóng</a>
                        <a id="yesOptionChangeIsShow" type="button" class="btn
                                            btn-danger">Đồng ý</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- modal delete all -->
        <div class="modal fade" id="confirmationDeleteIdsAddProduct" tabindex="-1" role="dialog"
            aria-labelledby="modelTitleId" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Xác nhận xóa hết sản phẩm</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Bạn có muốn xóa hết sản phẩm đã chọn?
                    </div>
                    <div class="modal-footer">
                        <a type="button" class="btn btn-outline-dark" data-dismiss="modal">Đóng</a>
                        <a onclick="deleteAll('deleteAllByIds', 'AddProduct')" type="button"
                            class="btn btn-danger">Xóa</a>
                    </div>
                </div>
            </div>
        </div>
        <script>
            $(document).ready(function () {
                $('[data-toggle="popover"]').popover();
            });
        </script>
        <script th:inline="javascript">
            window.onload = function () {
                var messageSuccess = '[[${messageSuccess}]]';
                var messageDanger = '[[${messageDanger}]]';
                $('#toastsCustomCss').attr("style", "position: absolute; top: 70px; right: 0;z-index: 1;");
                if (messageSuccess.length !== 0) {
                    $("#messageSuccess").toast("show");
                }
                if (messageDanger.length !== 0) {
                    $("#messageDanger").toast("show");
                }
            }
        </script>
        <!-- <script>
            //             $(document).ready(function(){

            // var native_width = 0;
            // var native_height = 0;

            // //Now the mousemove function
            // $(".magnify").mousemove(function(e){
            //     //When the user hovers on the image, the script will first calculate
            //     //the native dimensions if they don't exist. Only after the native dimensions
            //     //are available, the script will show the zoomed version.
            //     if(!native_width && !native_height)
            //     {
            //         //This will create a new image object with the same image as that in .small
            //         //We cannot directly get the dimensions from .small because of the 
            //         //width specified to 200px in the html. To get the actual dimensions we have
            //         //created this image object.
            //         var image_object = new Image();
            //         image_object.src = $(".small").attr("src");

            //         //This code is wrapped in the .load function which is important.
            //         //width and height of the object would return 0 if accessed before 
            //         //the image gets loaded.
            //         native_width = image_object.width;
            //         native_height = image_object.height;
            //     }
            //     else
            //     {
            //         //x/y coordinates of the mouse
            //         //This is the position of .magnify with respect to the document.
            //         var magnify_offset = $(this).offset();
            //         //We will deduct the positions of .magnify from the mouse positions with
            //         //respect to the document to get the mouse positions with respect to the 
            //         //container(.magnify)
            //         var mx = e.pageX - magnify_offset.left;
            //         var my = e.pageY - magnify_offset.top;

            //         //Finally the code to fade out the glass if the mouse is outside the container
            //         if(mx < $(this).width() && my < $(this).height() && mx > 0 && my > 0)
            //         {
            //             $(".large").fadeIn(100);
            //         }
            //         else
            //         {
            //             $(".large").fadeOut(100);
            //         }
            //         if($(".large").is(":visible"))
            //         {
            //             //The background position of .large will be changed according to the position
            //             //of the mouse over the .small image. So we will get the ratio of the pixel
            //             //under the mouse pointer with respect to the image and use that to position the 
            //             //large image inside the magnifying glass
            //             var rx = Math.round(mx/$(".small").width()*native_width - $(".large").width()/2)*-1;
            //             var ry = Math.round(my/$(".small").height()*native_height - $(".large").height()/2)*-1;
            //             var bgp = rx + "px " + ry + "px";

            //             //Time to move the magnifying glass with the mouse
            //             var px = mx - $(".large").width()/2;
            //             var py = my - $(".large").height()/2;
            //             //Now the glass moves with the mouse
            //             //The logic is to deduct half of the glass's width and height from the 
            //             //mouse coordinates to place it with its center at the mouse coordinates

            //             //If you hover on the image now, you should see the magnifying glass in action
            //             $(".large").css({left: px, top: py, backgroundPosition: bgp});
            //         }
            //     }
            // })
            // }) 
            // const preview = (file) => {
            //     const fr = new FileReader();
            //     fr.onload = () => {
            //         const img = document.createElement("img");
            //         img.src = fr.result; // String Base64
            //         img.alt = file.name;
            //         img.style.maxHeight = "120px";
            //         img.style.margin = "5px";
            //         document.querySelector("#preview").append(img);
            //     };
            //     fr.readAsDataURL(file);
            // };

            // document.querySelector("#files").addEventListener("change", (ev) => {
            //     if (!ev.target.files) return; // Do nothing.
            //     [...ev.target.files].forEach(preview);
            // });
            $(document).ready(function () {
        $("#test-upload").fileinput({
            'theme': 'fa5',
            'showPreview': false,
            'allowedFileExtensions': ['jpg', 'png', 'gif'],
            'elErrorContainer': '#errorBlock'
        });
        $("#kv-explorer").fileinput({
            'theme': 'explorer-fa5',
            'uploadUrl': '#',
            overwriteInitial: false,
            initialPreviewAsData: true,
            initialPreview: [
                "http://lorempixel.com/1920/1080/nature/1",
                "http://lorempixel.com/1920/1080/nature/2",
                "http://lorempixel.com/1920/1080/nature/3"
            ],
            initialPreviewConfig: [{
                    caption: "nature-1.jpg",
                    size: 329892,
                    width: "120px",
                    url: "{$url}",
                    key: 1
                },
                {
                    caption: "nature-2.jpg",
                    size: 872378,
                    width: "120px",
                    url: "{$url}",
                    key: 2
                },
                {
                    caption: "nature-3.jpg",
                    size: 632762,
                    width: "120px",
                    url: "{$url}",
                    key: 3
                }
            ]
        });
        /*
         $("#test-upload").on('fileloaded', function(event, file, previewId, index) {
         alert('i = ' + index + ', id = ' + previewId + ', file = ' + file.name);
         });
         */
        $('#inp-add-1').on('change', function () {
            var $plugin = $('#inp-add-2').data('fileinput');
            $plugin.addToStack($(this)[0].files[0])
        });
        $('#inp-add-2').fileinput({
            uploadUrl: '#',
            //uploadUrl: 'http://localhost/plugins/test-upload',
            initialPreviewAsData: true,
            initialPreview: [
                "https://dummyimage.com/640x360/a0f.png&text=Transport+1",
                "https://dummyimage.com/640x360/3a8.png&text=Transport+2",
                "https://dummyimage.com/640x360/6ff.png&text=Transport+3"
            ],
            initialPreviewConfig: [{
                    caption: "transport-1.jpg",
                    size: 329892,
                    width: "120px",
                    url: "{$url}",
                    key: 1,
                    zoomData: 'https://dummyimage.com/1920x1080/a0f.png&text=Transport+1',
                    description: '<h5>NUMBER 1</h5> The first choice for transport. This is the future.'
                },
                {
                    caption: "transport-2.jpg",
                    size: 872378,
                    width: "120px",
                    url: "{$url}",
                    key: 2,
                    zoomData: 'https://dummyimage.com/1920x1080/3a8.png&text=Transport+2',
                    description: '<h5>NUMBER 2</h5> The second choice for transport. This is the future.'
                },
                {
                    caption: "transport-3.jpg",
                    size: 632762,
                    width: "120px",
                    url: "{$url}",
                    key: 3,
                    zoomData: 'https://dummyimage.com/1920x1080/6ff.png&text=Transport+3',
                    description: '<h5>NUMBER 3</h5> The third choice for transport. This is the future.'
                }
            ]
        });
    });
        </script> -->
    </section>
</body>

</html>